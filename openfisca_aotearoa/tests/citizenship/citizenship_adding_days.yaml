---

- name: "NZ citizenship"
  period: 2015
  input:
    persons:
      "Tahi":
        present_in_new_zealand:
          "2015-01-01": true
          "2015-01-02": true
          "2015-01-03": false
          "2015-01-04": true
          "2015-01-05": true
          "2015-01-06": false
        immigration__entitled_to_indefinite_stay:
          "2015-01-01": true
          "2015-01-02": true
          "2015-01-03": false
          "2015-01-04": true
          "2015-01-05": true
          "2015-01-06": false
  output:
    days_present_in_new_zealand_in_preceeding_year:
      "2014-12-30": 0
      "2014-12-31": 0

      # This is the day they arrive in NZ, but we count
      # from the rolling year from day before
      "2015-01-01": 0

      "2015-01-02": 1
      "2015-01-03": 2
      "2015-01-04": 2
      "2015-01-05": 3
      "2015-01-06": 4
      "2015-01-07": 4

      # A year later
      "2015-12-30": 4
      "2015-12-31": 4
      "2016-01-01": 4
      "2016-01-02": 3
      "2016-01-03": 2
      "2016-01-04": 2
      "2016-01-05": 1
      "2016-02-06": 0
      "2016-02-07": 0
      # 5 years later
      "2019-12-30": 0
      "2019-12-31": 0
      "2020-01-01": 0
      "2020-01-02": 0
      "2020-01-03": 0
      "2020-01-04": 0
      "2020-01-05": 0
      "2020-01-06": 0
      "2020-01-07": 0
    days_present_in_new_zealand_in_preceeding_5_years:
      "2014-12-30": 0
      "2014-12-31": 0

      "2015-01-01": 1
      "2015-01-02": 2
      "2015-01-03": 2
      "2015-01-04": 3
      "2015-01-05": 4
      "2015-01-06": 4
      "2015-01-07": 4
      # A year later
      "2015-12-30": 4
      "2015-12-31": 4
      "2016-01-01": 4
      "2016-01-02": 4
      "2016-01-04": 4
      "2016-01-05": 4
      "2016-01-06": 4
      "2016-01-07": 4
      # each year
      "2017-01-01": 4
      "2018-01-01": 4
      "2019-01-01": 4
      # 5 years later
      "2019-12-30": 4
      "2019-12-31": 4
      "2020-01-01": 4
      "2020-01-02": 3
      "2020-01-03": 2
      "2020-01-04": 2
      "2020-01-05": 1
      "2020-01-06": 0
      "2020-01-07": 0
